# 12拓扑最终设计说明 (2025-12-12)

**重要**: 本文档为2025-12-12最终确认版本，替代所有之前的拓扑设计文档

## 设计原则

1. **基于截图实现**: 严格按照`Snipaste_2025-12-12_01-16-29.png`中的拓扑图实现
2. **上行/下行对应关系**: topo01-06为上行，topo07-12为下行
3. **协作链路**: 下行在上行基础上增加1-2条协作链路
4. **物理参数**: 使用师妹的NOMA物理模型计算真实链路质量

## 12拓扑详细定义

### Z1场景: 直连NOMA

**topo01 (上行)**: SAT ← S2(地面,低RSSI) + S1(UAV,高RSSI)
- 节点: sat, s2_ground, s1_uav
- 链路: s2_ground→sat, s1_uav→sat
- 参数: 59.27 Mbps, 2.71 ms, 3% loss

**topo07 (下行)**: SAT → S1(UAV,高RSSI) + S2(地面,低RSSI), S1→S2协作
- 节点: sat, s2_ground, s1_uav
- 链路: sat→s1_uav, sat→s2_ground, s1_uav→s2_ground (协作)
- 参数: 69.43 Mbps, 5.42 ms, 2% loss
- **✓ 下行带宽 > 上行** (1.171×)

### Z2场景: T协作接入(混合双路径)

**topo02 (上行)**: T通过S2/R1(地面)或S1/R2(UAV)双路径上行
- 节点: sat, s2_r1_ground, s1_r2_uav, t_ground
- 链路: s2_r1_ground→sat, s1_r2_uav→sat, t_ground→s2_r1_ground, t_ground→s1_r2_uav
- 参数: 16.55 Mbps, 2.72 ms, 3% loss

**topo08 (下行)**: SAT → S1/R2(UAV) + S2/R1(地面) → T(地面), S1→S2协作
- 节点: sat, s2_r1_ground, s1_r2_uav, t_ground
- 链路: sat→s2_r1_ground, sat→s1_r2_uav, s1_r2_uav→s2_r1_ground (协作), s2_r1_ground→t_ground, s1_r2_uav→t_ground
- 参数: 44.84 Mbps, 5.42 ms, 2% loss
- **✓ 下行带宽 > 上行** (2.709×, 提升最大!)

### Z3场景: T用户协作NOMA

**topo03 (上行)**: 两个地面T用户通过UAV中继上行
- 节点: sat, s_r_uav, t2_ground, t1_ground
- 链路: s_r_uav→sat, t2_ground→s_r_uav, t1_ground→s_r_uav
- 参数: 25.19 Mbps, 2.71 ms, 1% loss

**topo09 (下行)**: SAT → S/R(UAV) → T1(地面) + T2(地面), T1→T2协作
- 节点: sat, s_r_uav, t1_ground, t2_ground
- 链路: sat→s_r_uav, s_r_uav→t1_ground, s_r_uav→t2_ground, t1_ground→t2_ground (协作)
- 参数: 29.84 Mbps, 2.72 ms, 0.5% loss
- **✓ 下行带宽 > 上行** (1.185×)

### Z4场景: 混合直连+协作

**topo04 (上行)**: S2(地面)直连，T通过S1/R(UAV)上行
- 节点: sat, s2_ground, s1_r_uav, t_ground
- 链路: s2_ground→sat, s1_r_uav→sat, t_ground→s1_r_uav
- 参数: 23.64 Mbps, 2.72 ms, 3% loss

**topo10 (下行)**: SAT → S2(地面)直连 + SAT → S1/R(UAV) → T(地面), S1→S2协作
- 节点: sat, s2_ground, s1_r_uav, t_ground
- 链路: sat→s2_ground, sat→s1_r_uav, s1_r_uav→s2_ground (协作), s1_r_uav→t_ground
- 参数: 28.29 Mbps, 5.42 ms, 2% loss
- **✓ 下行带宽 > 上行** (1.197×)

### Z5场景: 多层树形结构 ⚠️

**topo05 (上行)**: S2(地面)直连，T1/T2通过S1/R(UAV)上行
- 节点: sat, s2_ground, s1_r_uav, t1_ground, t2_ground
- 链路: s2_ground→sat, s1_r_uav→sat, t1_ground→s1_r_uav, t2_ground→s1_r_uav
- 参数: 25.19 Mbps, 2.72 ms, 3% loss

**topo11 (下行)**: SAT → S1(UAV) + S2/R(地面) [NOMA], S1→S2/R协作, S2/R→T1/T2, T1↔T2协作
- 节点: sat, s1_uav, s2_r_ground, t1_ground, t2_ground
- 链路: sat→s1_uav, sat→s2_r_ground, s1_uav→s2_r_ground (协作), s2_r_ground→t1_ground, s2_r_ground→t2_ground, t1_ground→t2_ground (协作)
- 参数: 9.67 Mbps, 5.42 ms, 2% loss
- **⚠️ 下行带宽 < 上行** (0.384×, 下降62%)
- **问题**: 瓶颈在地面D2D转发，需明天与老师确认设计合理性

### Z6场景: 双UAV中继+T用户 ⚠️

**topo06 (上行)**: 两个UAV分别中继一个地面T用户
- 节点: sat, s1_r1_uav, s2_r2_uav, t1_ground, t2_ground
- 链路: s1_r1_uav→sat, s2_r2_uav→sat, t1_ground→s1_r1_uav, t2_ground→s2_r2_uav
- 参数: 22.91 Mbps, 2.72 ms, 1% loss

**topo12 (下行)**: SAT → S1/R1(UAV) + S2/R2(地面) [NOMA], S1/R1→S2/R2协作, S1/R1→T1, S2/R2→T2
- 节点: sat, s1_r1_uav, s2_r2_ground, t1_ground, t2_ground
- 链路: sat→s1_r1_uav, sat→s2_r2_ground, s1_r1_uav→s2_r2_ground (协作), s1_r1_uav→t1_ground, s2_r2_ground→t2_ground
- 参数: 8.73 Mbps, 5.42 ms, 2% loss
- **⚠️ 下行带宽 < 上行** (0.381×, 下降62%)
- **问题**: topo06使用两个UAV，但topo12一个UAV+一个地面节点，需明天与老师确认设计合理性

## 性能统计汇总

### 上行带宽范围
- 最低: 16.55 Mbps (topo02 - T协作接入，瓶颈在地面路径)
- 最高: 59.27 Mbps (topo01 - 直连NOMA，UAV高RSSI)
- 平均: 28.79 Mbps

### 下行带宽范围
- 最低: 8.73 Mbps (topo12 - 地面节点转发瓶颈) ⚠️
- 最高: 69.43 Mbps (topo07 - 直连NOMA下行，卫星发射功率高)
- 平均: 31.80 Mbps

### 关键发现

**✓ Z1-Z4: 下行优于上行 (符合物理规律)**
- Z1: 上行 59.27 → 下行 69.43 Mbps (1.171×)
- Z2: 上行 16.55 → 下行 44.84 Mbps (2.709×) ← **提升最大**
- Z3: 上行 25.19 → 下行 29.84 Mbps (1.185×)
- Z4: 上行 23.64 → 下行 28.29 Mbps (1.197×)

**⚠️ Z5-Z6: 下行劣于上行 (需确认设计)**
- Z5: 上行 25.19 → 下行 9.67 Mbps (0.384×) ← 下降62%
- Z6: 上行 22.91 → 下行 8.73 Mbps (0.381×) ← **最差**

**原因分析**:
- Z5/Z6下行采用"NOMA接收+地面转发"模式
- 瓶颈在地面D2D链路 (8-9 Mbps)
- 而上行使用UAV中继 (22-25 Mbps)
- 这违背了"卫星下行功率高→下行应优于上行"的物理规律

## 待确认问题

**明天需与老师确认**:

1. **topo11设计合理性**
   - 为何下行使用S2/R地面节点转发而非S1/R UAV中继？
   - 是否可改为: SAT → S2(地面)直连 + SAT → S1/R(UAV) → T1/T2, S1→S2协作？

2. **topo12设计合理性**
   - 为何topo06上行用两个UAV，但topo12下行一个UAV + 一个地面？
   - 是否应保持对称: topo12也用两个UAV？

3. **物理合理性验证**
   - 是否接受Z5/Z6下行劣于上行的现实？
   - 还是修正为符合"下行>=上行"的物理规律？

## 文件位置

- **拓扑定义**: `/home/ccc/pq-ntor-experiment/last_experiment/topology_node_positions.py`
- **物理参数**: `/home/ccc/pq-ntor-experiment/last_experiment/topology_params.json`
- **截图参考**: `/home/ccc/pq-ntor-experiment/Snipaste_2025-12-12_01-16-29.png`

## 修改历史

- **2025-12-12**: 按截图实现所有拓扑，发现Z5/Z6问题，等待老师确认
- **之前版本**: 已移至 `OLD_INCORRECT_DOCS_20251212/` 目录，不再参考

---

**生成时间**: 2025-12-12
**状态**: 等待老师确认 topo11/12 设计合理性
**验证**: ✓ Z1-Z4符合物理规律 | ⚠️ Z5-Z6需确认设计
