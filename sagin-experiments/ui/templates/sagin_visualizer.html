<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAGIN PQ-NTOR ç½‘ç»œæ‹“æ‰‘å¯è§†åŒ–</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(to bottom, #000428, #004e92);
            color: #00ff00;
            overflow: hidden;
        }

        #container {
            display: flex;
            flex-direction: column;
            height: 100vh;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 20px;
        }

        h1 {
            font-size: 28px;
            text-shadow: 0 0 10px #00ff00;
            letter-spacing: 2px;
        }

        #main-content {
            display: flex;
            gap: 20px;
            flex: 1;
        }

        #canvas-container {
            flex: 3;
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid #00ff00;
            border-radius: 10px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #networkCanvas {
            display: block;
            max-width: 100%;
            max-height: 100%;
        }

        #stats-panel {
            flex: 1;
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid #00ff00;
            border-radius: 10px;
            padding: 20px;
            overflow-y: auto;
        }

        .stat-section {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #004400;
        }

        .stat-section:last-child {
            border-bottom: none;
        }

        .stat-title {
            color: #ffaa00;
            font-size: 16px;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .stat-item {
            margin: 8px 0;
            font-size: 14px;
            display: flex;
            justify-content: space-between;
        }

        .stat-label {
            color: #aaaaaa;
        }

        .stat-value {
            color: #00ff00;
            font-weight: bold;
        }

        #legend {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border: 1px solid #00ff00;
            border-radius: 5px;
            font-size: 12px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin: 5px 0;
        }

        .legend-icon {
            width: 20px;
            height: 3px;
            margin-right: 8px;
        }

        .link-active {
            background: #00ff00;
        }

        .link-inactive {
            background: #444444;
        }

        #timestamp {
            text-align: center;
            margin-top: 10px;
            color: #888888;
            font-size: 12px;
        }

        .blink {
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }
    </style>
</head>
<body>
    <div id="container">
        <header>
            <h1>ğŸ›°ï¸ SAGIN PQ-NTOR ç½‘ç»œæ‹“æ‰‘å®æ—¶æ¼”ç¤º ğŸŒ</h1>
        </header>

        <div id="main-content">
            <div id="canvas-container">
                <canvas id="networkCanvas" width="1000" height="800"></canvas>

                <div id="legend">
                    <div style="font-weight: bold; margin-bottom: 8px;">å›¾ä¾‹</div>
                    <div class="legend-item">
                        <div class="legend-icon link-active"></div>
                        <span>æ´»è·ƒé“¾è·¯</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-icon link-inactive"></div>
                        <span>ä¸å¯è§é“¾è·¯</span>
                    </div>
                    <div style="margin-top: 10px;">
                        <div>ğŸŸ¢ å«æ˜ŸèŠ‚ç‚¹</div>
                        <div>ğŸŸ  é£è¡Œå™¨èŠ‚ç‚¹</div>
                        <div>ğŸ”´ åœ°é¢ç«™</div>
                    </div>
                </div>
            </div>

            <div id="stats-panel">
                <div class="stat-section">
                    <div class="stat-title">ğŸ“Š PQ-NTOR ç»Ÿè®¡</div>
                    <div class="stat-item">
                        <span class="stat-label">æ¡æ‰‹æ¬¡æ•°:</span>
                        <span class="stat-value" id="handshakes">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">å¹³å‡å»¶è¿Ÿ:</span>
                        <span class="stat-value" id="avg-delay">49 Î¼s</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">æ´»è·ƒç”µè·¯:</span>
                        <span class="stat-value" id="circuits">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">ä¼ è¾“æµé‡:</span>
                        <span class="stat-value" id="data-transfer">0 MB</span>
                    </div>
                </div>

                <div class="stat-section">
                    <div class="stat-title">ğŸ”— é“¾è·¯çŠ¶æ€</div>
                    <div id="link-status">
                        <!-- åŠ¨æ€å¡«å…… -->
                    </div>
                </div>

                <div class="stat-section">
                    <div class="stat-title">ğŸŒ ç½‘ç»œèŠ‚ç‚¹</div>
                    <div class="stat-item">
                        <span class="stat-label">å«æ˜Ÿ:</span>
                        <span class="stat-value">2ä¸ª (Sat-1, Sat-2)</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">é£è¡Œå™¨:</span>
                        <span class="stat-value">2ä¸ª (Aircraft)</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">åœ°é¢ç«™:</span>
                        <span class="stat-value">3ä¸ª (GS)</span>
                    </div>
                </div>

                <div class="stat-section">
                    <div class="stat-title">âš™ï¸ ç³»ç»ŸçŠ¶æ€</div>
                    <div class="stat-item">
                        <span class="stat-label">åè®®:</span>
                        <span class="stat-value">PQ-NTOR (Kyber-512)</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">ç½‘ç»œ:</span>
                        <span class="stat-value blink">è¿è¡Œä¸­</span>
                    </div>
                </div>
            </div>
        </div>

        <div id="timestamp">UTCæ—¶é—´: --</div>
    </div>

    <script>
        const canvas = document.getElementById('networkCanvas');
        const ctx = canvas.getContext('2d');

        // Canvaså›ºå®šå°ºå¯¸ï¼ˆç¡®ä¿ä¸å˜å½¢ï¼‰
        const CANVAS_WIDTH = 1000;
        const CANVAS_HEIGHT = 800;
        canvas.width = CANVAS_WIDTH;
        canvas.height = CANVAS_HEIGHT;

        // åœ°çƒå‚æ•°ï¼ˆå±…ä¸­ï¼‰
        const EARTH_CENTER_X = CANVAS_WIDTH / 2;   // 500
        const EARTH_CENTER_Y = CANVAS_HEIGHT / 2;  // 400
        const EARTH_RADIUS = 80;

        // è½¨é“åŠå¾„ï¼ˆä»åœ°çƒä¸­å¿ƒåˆ°å«æ˜Ÿçš„è·ç¦»ï¼‰
        const ORBIT_RADIUS = {
            satellite: 280,   // å«æ˜Ÿè½¨é“
            aircraft: 180,    // é£è¡Œå™¨è½¨é“
            ground: 110       // åœ°é¢ç«™ï¼ˆåœ¨åœ°çƒè¡¨é¢é™„è¿‘ï¼‰
        };

        // ç»˜åˆ¶3Dç«‹ä½“åœ°çƒ
        function drawEarth(cx, cy, radius) {
            ctx.save();

            // 1. å¤–å±‚å¤§æ°”å…‰æ™•ï¼ˆè“è‰²å¤§æ°”å±‚ï¼‰
            const atmosphereGlow = ctx.createRadialGradient(cx, cy, radius * 0.95, cx, cy, radius + 25);
            atmosphereGlow.addColorStop(0, 'rgba(100, 180, 255, 0)');
            atmosphereGlow.addColorStop(0.7, 'rgba(100, 180, 255, 0.4)');
            atmosphereGlow.addColorStop(1, 'rgba(50, 100, 200, 0)');
            ctx.fillStyle = atmosphereGlow;
            ctx.beginPath();
            ctx.arc(cx, cy, radius + 25, 0, Math.PI * 2);
            ctx.fill();

            // 2. åœ°çƒåŸºç¡€çƒä½“ - æ·±è“è‰²æµ·æ´‹ï¼ˆä½¿ç”¨æ›´çœŸå®çš„æ¸å˜ï¼‰
            // å…‰æºåœ¨å·¦ä¸Šæ–¹ï¼Œåˆ›å»ºæ˜æš—å¯¹æ¯”
            const oceanGradient = ctx.createRadialGradient(
                cx - radius * 0.35, cy - radius * 0.35, radius * 0.2,  // é«˜å…‰ä½ç½®ï¼ˆå·¦ä¸Šï¼‰
                cx, cy, radius * 1.2  // çƒä½“è¾¹ç¼˜
            );
            oceanGradient.addColorStop(0, '#5dade2');    // é«˜å…‰åŒºåŸŸ - äº®è“è‰²
            oceanGradient.addColorStop(0.25, '#3498db'); // è¿‡æ¸¡åŒº - æ ‡å‡†è“
            oceanGradient.addColorStop(0.6, '#2874a6');  // ä¸­é—´åŒº - ä¸­è“
            oceanGradient.addColorStop(0.85, '#1b4f72'); // è¾¹ç¼˜åŒº - æ·±è“
            oceanGradient.addColorStop(1, '#0d2a42');    // æœ€æš—åŒº - ææ·±è“

            ctx.fillStyle = oceanGradient;
            ctx.beginPath();
            ctx.arc(cx, cy, radius, 0, Math.PI * 2);
            ctx.fill();

            // 3. ç»˜åˆ¶å¤§é™†ï¼ˆä½¿ç”¨æ­£ç¡®çš„åœ°ç†ä½ç½®ï¼‰
            ctx.fillStyle = '#27ae60';  // é™†åœ°ç»¿è‰²
            ctx.globalAlpha = 0.85;

            // è£å‰ªåˆ°åœ°çƒåœ†å½¢å†…
            ctx.beginPath();
            ctx.arc(cx, cy, radius, 0, Math.PI * 2);
            ctx.clip();

            // === æ¬§æ´²å’Œéæ´²ï¼ˆä¸­é—´åå³ï¼‰===
            // æ¬§æ´²
            ctx.beginPath();
            ctx.ellipse(cx + 8, cy - 25, 18, 15, -0.2, 0, Math.PI * 2);
            ctx.fill();

            // éæ´²ï¼ˆæ¬§æ´²ä¸‹æ–¹ï¼‰
            ctx.beginPath();
            ctx.moveTo(cx + 5, cy - 8);
            ctx.quadraticCurveTo(cx + 25, cy + 5, cx + 20, cy + 30);
            ctx.quadraticCurveTo(cx + 10, cy + 35, cx, cy + 25);
            ctx.quadraticCurveTo(cx - 5, cy, cx + 5, cy - 8);
            ctx.fill();

            // === äºšæ´²ï¼ˆå³ä¾§ï¼‰===
            // è¥¿äºš
            ctx.beginPath();
            ctx.ellipse(cx + 28, cy - 10, 12, 18, 0.3, 0, Math.PI * 2);
            ctx.fill();

            // ä¸œäºšï¼ˆä¸­å›½ã€æ—¥æœ¬ï¼‰- å³è¾¹ç¼˜
            ctx.beginPath();
            ctx.ellipse(cx + 55, cy - 5, 20, 25, 0.1, 0, Math.PI * 2);
            ctx.fill();

            // === ç¾æ´²ï¼ˆå·¦ä¾§ï¼‰===
            // åŒ—ç¾ï¼ˆå·¦ä¸Šï¼‰
            ctx.beginPath();
            ctx.moveTo(cx - 55, cy - 30);
            ctx.quadraticCurveTo(cx - 35, cy - 35, cx - 25, cy - 25);
            ctx.quadraticCurveTo(cx - 20, cy - 10, cx - 30, cy + 5);
            ctx.quadraticCurveTo(cx - 50, cy + 5, cx - 55, cy - 10);
            ctx.lineTo(cx - 55, cy - 30);
            ctx.fill();

            // å—ç¾ï¼ˆå·¦ä¸‹ï¼‰
            ctx.beginPath();
            ctx.ellipse(cx - 38, cy + 20, 12, 22, 0.4, 0, Math.PI * 2);
            ctx.fill();

            // === æ¾³å¤§åˆ©äºšï¼ˆå³ä¸‹ï¼‰===
            ctx.beginPath();
            ctx.ellipse(cx + 50, cy + 30, 15, 12, -0.2, 0, Math.PI * 2);
            ctx.fill();

            // === å—ææ´²ï¼ˆåº•éƒ¨ï¼‰===
            ctx.beginPath();
            ctx.ellipse(cx, cy + 65, 50, 18, 0, 0, Math.PI * 2);
            ctx.fill();

            ctx.globalAlpha = 1.0;

            // 4. å¤§é™†é˜´å½±ï¼ˆå¢å¼º3Dæ•ˆæœï¼‰
            const landShadow = ctx.createRadialGradient(
                cx + radius * 0.3, cy + radius * 0.3, 0,
                cx + radius * 0.3, cy + radius * 0.3, radius * 0.8
            );
            landShadow.addColorStop(0, 'rgba(0, 0, 0, 0)');
            landShadow.addColorStop(1, 'rgba(0, 0, 0, 0.35)');
            ctx.fillStyle = landShadow;
            ctx.beginPath();
            ctx.arc(cx, cy, radius, 0, Math.PI * 2);
            ctx.fill();

            // 5. äº‘å±‚æ•ˆæœï¼ˆç™½è‰²åŠé€æ˜ï¼‰
            ctx.fillStyle = 'rgba(255, 255, 255, 0.2)';
            ctx.globalAlpha = 0.6;

            // å¤šä¸ªäº‘å›¢
            ctx.beginPath();
            ctx.ellipse(cx - 30, cy - 15, 18, 10, 0.3, 0, Math.PI * 2);
            ctx.fill();

            ctx.beginPath();
            ctx.ellipse(cx + 25, cy - 30, 15, 8, -0.2, 0, Math.PI * 2);
            ctx.fill();

            ctx.beginPath();
            ctx.ellipse(cx - 15, cy + 20, 20, 12, 0.5, 0, Math.PI * 2);
            ctx.fill();

            ctx.globalAlpha = 1.0;

            // 6. æ¢å¤è£å‰ª
            ctx.restore();
            ctx.save();

            // 7. çƒä½“é«˜å…‰ï¼ˆå·¦ä¸Šè§’å¼ºå…‰åå°„ï¼‰
            const highlight = ctx.createRadialGradient(
                cx - radius * 0.4, cy - radius * 0.4, 0,
                cx - radius * 0.4, cy - radius * 0.4, radius * 0.5
            );
            highlight.addColorStop(0, 'rgba(255, 255, 255, 0.4)');
            highlight.addColorStop(0.5, 'rgba(255, 255, 255, 0.15)');
            highlight.addColorStop(1, 'rgba(255, 255, 255, 0)');
            ctx.fillStyle = highlight;
            ctx.beginPath();
            ctx.arc(cx, cy, radius, 0, Math.PI * 2);
            ctx.fill();

            // 8. åœ°çƒè¾¹ç¼˜é«˜å…‰ï¼ˆ3Dç«‹ä½“è¾¹ç¼˜ï¼‰
            ctx.strokeStyle = 'rgba(150, 200, 255, 0.6)';
            ctx.lineWidth = 2.5;
            ctx.shadowColor = '#5dade2';
            ctx.shadowBlur = 8;
            ctx.beginPath();
            ctx.arc(cx, cy, radius, 0, Math.PI * 2);
            ctx.stroke();
            ctx.shadowBlur = 0;

            // 9. åœ°çƒæ ‡ç­¾
            ctx.fillStyle = '#ffffff';
            ctx.font = 'bold 16px Arial';
            ctx.textAlign = 'center';
            ctx.shadowColor = '#000000';
            ctx.shadowBlur = 5;
            ctx.fillText('EARTH', cx, cy + radius + 25);
            ctx.shadowBlur = 0;

            ctx.restore();
        }

        // ç»˜åˆ¶è½¨é“åœ†åœˆï¼ˆæ¯ä¸ªå«æ˜Ÿ/é£è¡Œå™¨ç‹¬ç«‹çš„è½¨é“ï¼‰
        function drawOrbit(cx, cy, radius, color, label) {
            ctx.save();
            ctx.strokeStyle = color;
            ctx.lineWidth = 1.5;
            ctx.setLineDash([8, 8]);
            ctx.globalAlpha = 0.4;

            ctx.beginPath();
            ctx.arc(cx, cy, radius, 0, Math.PI * 2);
            ctx.stroke();

            ctx.setLineDash([]);
            ctx.globalAlpha = 1.0;

            // è½¨é“æ ‡ç­¾
            ctx.fillStyle = color;
            ctx.font = '11px Arial';
            ctx.textAlign = 'center';
            ctx.fillText(label, cx + radius, cy - 5);

            ctx.restore();
        }

        // ç»˜åˆ¶èŠ‚ç‚¹
        function drawNode(x, y, name, type, color, isActive = true) {
            ctx.save();

            // ç¡®ä¿èŠ‚ç‚¹åœ¨ç”»å¸ƒå†…
            x = Math.max(30, Math.min(CANVAS_WIDTH - 30, x));
            y = Math.max(30, Math.min(CANVAS_HEIGHT - 30, y));

            if (isActive) {
                // èŠ‚ç‚¹å…‰æ™•
                const glowGradient = ctx.createRadialGradient(x, y, 0, x, y, 20);
                glowGradient.addColorStop(0, color);
                glowGradient.addColorStop(1, 'rgba(0,0,0,0)');
                ctx.fillStyle = glowGradient;
                ctx.fillRect(x - 20, y - 20, 40, 40);
            }

            // èŠ‚ç‚¹æœ¬ä½“
            ctx.fillStyle = color;
            ctx.beginPath();
            ctx.arc(x, y, 8, 0, Math.PI * 2);
            ctx.fill();

            // èŠ‚ç‚¹è¾¹æ¡†
            ctx.strokeStyle = '#ffffff';
            ctx.lineWidth = 2;
            ctx.stroke();

            // èŠ‚ç‚¹æ ‡ç­¾ï¼ˆåç§°ï¼‰
            ctx.fillStyle = '#ffffff';
            ctx.font = 'bold 13px Arial';
            ctx.textAlign = 'center';
            ctx.shadowColor = '#000000';
            ctx.shadowBlur = 3;
            ctx.fillText(name, x, y - 15);

            // èŠ‚ç‚¹ç±»å‹å›¾æ ‡
            let icon = '';
            if (type === 'satellite') icon = 'ğŸ›°ï¸';
            else if (type === 'aircraft') icon = 'âœˆï¸';
            else icon = 'ğŸ“¡';
            ctx.font = '18px Arial';
            ctx.fillText(icon, x, y + 25);

            ctx.shadowBlur = 0;
            ctx.restore();
        }

        // ç»˜åˆ¶é“¾è·¯
        function drawLink(x1, y1, x2, y2, isActive, linkType, delay) {
            ctx.save();

            if (isActive) {
                ctx.strokeStyle = '#00ff00';
                ctx.lineWidth = 2.5;
                ctx.shadowColor = '#00ff00';
                ctx.shadowBlur = 5;
                ctx.setLineDash([]);
            } else {
                ctx.strokeStyle = '#444444';
                ctx.lineWidth = 1;
                ctx.setLineDash([5, 5]);
            }

            ctx.beginPath();
            ctx.moveTo(x1, y1);
            ctx.lineTo(x2, y2);
            ctx.stroke();

            ctx.shadowBlur = 0;

            // é“¾è·¯æ ‡ç­¾ï¼ˆåªåœ¨æ´»è·ƒæ—¶æ˜¾ç¤ºï¼‰
            if (isActive) {
                const midX = (x1 + x2) / 2;
                const midY = (y1 + y2) / 2;

                // æ ‡ç­¾èƒŒæ™¯
                ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';
                const labelText = `${linkType} ${delay}ms`;
                ctx.font = '11px Arial';
                const textWidth = ctx.measureText(labelText).width;
                ctx.fillRect(midX - textWidth/2 - 4, midY - 10, textWidth + 8, 18);

                // æ ‡ç­¾æ–‡å­—
                ctx.fillStyle = '#ffaa00';
                ctx.textAlign = 'center';
                ctx.fillText(labelText, midX, midY + 3);
            }

            ctx.setLineDash([]);
            ctx.restore();
        }

        // æ›´æ–°æ˜¾ç¤º
        function updateVisualization(data) {
            // æ¸…ç©ºç”»å¸ƒ
            ctx.fillStyle = '#000000';
            ctx.fillRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);

            // ç»˜åˆ¶æ˜Ÿç©ºèƒŒæ™¯
            ctx.fillStyle = '#ffffff';
            for (let i = 0; i < 150; i++) {
                const x = Math.random() * CANVAS_WIDTH;
                const y = Math.random() * CANVAS_HEIGHT;
                const size = Math.random() * 2;
                const alpha = 0.3 + Math.random() * 0.7;
                ctx.globalAlpha = alpha;
                ctx.fillRect(x, y, size, size);
            }
            ctx.globalAlpha = 1.0;

            // ç»˜åˆ¶è½¨é“åœ†åœˆï¼ˆåœ¨ç»˜åˆ¶åœ°çƒä¹‹å‰ï¼Œä½œä¸ºèƒŒæ™¯ï¼‰
            drawOrbit(EARTH_CENTER_X, EARTH_CENTER_Y, ORBIT_RADIUS.satellite, '#00ff00', 'LEO 550km');
            drawOrbit(EARTH_CENTER_X, EARTH_CENTER_Y, ORBIT_RADIUS.aircraft, '#ffaa00', 'Aircraft Layer');

            // ç»˜åˆ¶åœ°çƒï¼ˆå±…ä¸­ï¼‰
            drawEarth(EARTH_CENTER_X, EARTH_CENTER_Y, EARTH_RADIUS);

            // ç»˜åˆ¶é“¾è·¯ï¼ˆåœ¨èŠ‚ç‚¹ä¹‹å‰ï¼Œé¿å…é®æŒ¡ï¼‰
            data.links.forEach(link => {
                const fromNode = data.nodes[link.from];
                const toNode = data.nodes[link.to];

                // é‡æ–°è®¡ç®—èŠ‚ç‚¹ä½ç½®ï¼ˆç¡®ä¿åŸºäºåœ°çƒä¸­å¿ƒï¼‰
                const fromX = fromNode.x;
                const fromY = fromNode.y;
                const toX = toNode.x;
                const toY = toNode.y;

                drawLink(fromX, fromY, toX, toY, link.active, link.type, link.delay);
            });

            // ç»˜åˆ¶èŠ‚ç‚¹
            Object.entries(data.nodes).forEach(([name, node]) => {
                drawNode(node.x, node.y, name, node.type, node.color);
            });

            // æ›´æ–°ç»Ÿè®¡é¢æ¿
            document.getElementById('handshakes').textContent = data.stats.handshakes;
            document.getElementById('avg-delay').textContent = data.stats.avg_delay_us + ' Î¼s';
            document.getElementById('circuits').textContent = data.stats.circuits;
            document.getElementById('data-transfer').textContent = data.stats.data_transferred_mb + ' MB';

            // æ›´æ–°é“¾è·¯çŠ¶æ€
            let linkStatusHTML = '';
            data.links.forEach(link => {
                const status = link.active ? 'ğŸŸ¢' : 'ğŸ”´';
                const color = link.active ? '#00ff00' : '#ff0000';
                linkStatusHTML += `
                    <div class="stat-item" style="font-size: 12px;">
                        <span>${status} ${link.from} â†’ ${link.to}</span>
                        <span style="color: ${color}">${link.active ? 'ON' : 'OFF'}</span>
                    </div>
                `;
            });
            document.getElementById('link-status').innerHTML = linkStatusHTML;

            // æ›´æ–°æ—¶é—´æˆ³
            document.getElementById('timestamp').textContent = 'UTCæ—¶é—´: ' + data.timestamp;
        }

        // å®šæœŸè·å–æ•°æ®å¹¶æ›´æ–°
        function fetchAndUpdate() {
            fetch('/api/topology')
                .then(response => response.json())
                .then(data => {
                    updateVisualization(data);
                })
                .catch(error => {
                    console.error('è·å–æ•°æ®å¤±è´¥:', error);
                });
        }

        // å¯åŠ¨æ›´æ–°å¾ªç¯ï¼ˆæ¯100msæ›´æ–°ä¸€æ¬¡ï¼Œå®ç°æµç•…åŠ¨ç”»ï¼‰
        fetchAndUpdate();
        setInterval(fetchAndUpdate, 100);
    </script>
</body>
</html>
