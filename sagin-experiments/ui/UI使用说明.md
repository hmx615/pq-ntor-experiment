# SAGIN卫星网络可视化UI - 使用说明

## ✅ 部署状态

**Web服务器已成功运行在飞腾派上！**

- 服务器地址: `192.168.5.110:5000`
- 状态: 运行中
- 端口: 5000 (已监听)

---

## 🌐 访问方式

### 方法1: 在您的PC浏览器访问（推荐）

打开浏览器，输入：
```
http://192.168.5.110:5000
```

### 方法2: 在飞腾派本地浏览器访问

如果飞腾派连接了显示器和鼠标：
```
http://localhost:5000
```

---

## 🎨 UI功能演示

### 可视化效果

#### 1. 卫星轨道动画
- 🌍 **地球** - 中心旋转的蓝色星球
- 🛰️ **Sat-1/Sat-2** - 绿色卫星节点，沿LEO轨道运动
- ✈️ **Aircraft-1/2** - 橙色飞行器节点，中层轨道
- 📡 **地面站** - 红色固定节点（北京/伦敦/纽约）

#### 2. 动态链路显示
- **绿色实线** - 活跃链路（卫星可见）
- **灰色虚线** - 不可见链路（卫星不在视野内）
- **链路标签** - 显示链路类型和延迟（如"ISL 10ms"）

#### 3. 实时统计面板
- **PQ-NTOR统计**
  - 握手次数（实时累加）
  - 平均延迟：49μs
  - 活跃电路数
  - 传输流量

- **链路状态**
  - 每条链路的实时状态（ON/OFF）
  - 🟢 绿色表示活跃
  - 🔴 红色表示断开

- **网络节点信息**
  - 卫星数量：2个
  - 飞行器：2个
  - 地面站：3个

---

## 🎯 效果预览

访问后您会看到：

```
┌────────────────────────────────────────────────────────┐
│          SAGIN PQ-NTOR 网络拓扑实时演示                │
├────────────────────────────────────────────────────────┤
│                                                        │
│   主显示区域（800x600画布）      │  统计面板           │
│                                  │                    │
│        ●Sat-2 (运动中)           │  PQ-NTOR统计:       │
│      ╱  ╲                        │   握手: 23次       │
│   ●─────●Sat-1                   │   延迟: 49μs       │
│  🌍       ╲                      │   电路: 2条        │
│  地球      ●Aircraft-1           │                    │
│             │                    │  链路状态:         │
│          ●──┴──●                 │   🟢 Sat-1→Sat-2   │
│        GS-Bei  GS-Lon            │   🟢 Sat-1→GS-Bei  │
│                                  │   🔴 Sat-2→GS-NY   │
│  (星空背景 + 轨道圈)              │                    │
│                                  │  系统状态: 运行中   │
└────────────────────────────────────────────────────────┘
```

**动画效果**:
- ⏱️ 卫星每秒移动0.5度（10帧/秒刷新）
- 🔗 链路根据卫星位置动态显示/隐藏
- 📊 统计数据实时更新
- ✨ "运行中"状态闪烁动画

---

## 🔧 控制命令

### 停止服务器

```bash
ssh user@192.168.5.110
pkill -f sagin_web_visualizer
```

### 重启服务器

```bash
ssh user@192.168.5.110
cd /home/user/sagin-ui
nohup python3 sagin_web_visualizer.py > server.log 2>&1 &
```

### 查看服务器日志

```bash
ssh user@192.168.5.110
cat /home/user/sagin-ui/server.log

# 实时查看
tail -f /home/user/sagin-ui/server.log
```

### 检查服务器状态

```bash
ssh user@192.168.5.110
ps aux | grep sagin_web_visualizer
netstat -tuln | grep 5000
```

---

## 📁 文件结构

```
/home/user/sagin-ui/
├── sagin_web_visualizer.py    # Flask后端服务器
├── templates/
│   └── sagin_visualizer.html  # 前端HTML5可视化
├── server.log                 # 服务器日志
└── static/                    # （预留，用于放置静态资源）
```

---

## 🎨 技术实现

### 后端 (Python + Flask)
- **Flask Web框架** - 提供HTTP服务
- **实时数据API** - `/api/topology` 返回JSON格式的网络拓扑
- **轨道计算** - 基于三角函数模拟卫星运动
- **链路可见性判断** - 根据角度差计算

### 前端 (HTML5 + Canvas)
- **Canvas 2D绘图** - 绘制地球、卫星、链路
- **定时刷新** - 每100ms请求一次数据，实现流畅动画
- **响应式布局** - 自适应屏幕大小
- **视觉效果** - 渐变、光晕、星空背景

---

## 🚀 下一步扩展

### 已实现 ✅
- [x] 卫星轨道运动动画
- [x] 链路动态显示
- [x] 实时统计面板
- [x] Web远程访问

### 可以添加 📝
- [ ] 集成真实的Skyfield轨道计算
- [ ] 连接到实际的PQ-NTOR程序获取真实统计
- [ ] 添加手动控制链路启用/禁用的按钮
- [ ] 3D视角（使用Three.js）
- [ ] 播放/暂停/快进控制
- [ ] 历史数据回放

---

## 🐛 故障排除

### 问题1: 浏览器无法访问

**检查**:
```bash
# 1. 检查服务器是否运行
ssh user@192.168.5.110
ps aux | grep sagin_web_visualizer

# 2. 检查端口是否开放
netstat -tuln | grep 5000

# 3. 检查防火墙
sudo ufw status
```

**解决**:
```bash
# 如果服务器未运行，手动启动
cd /home/user/sagin-ui
python3 sagin_web_visualizer.py
```

### 问题2: 显示空白或卡顿

**原因**: 浏览器兼容性或网络延迟

**解决**:
- 使用Chrome或Firefox浏览器
- 刷新页面（Ctrl+F5强制刷新）
- 检查浏览器控制台（F12）是否有错误

### 问题3: 统计数据不更新

**检查API**:
```bash
# 访问API测试
curl http://192.168.5.110:5000/api/topology

# 应该返回JSON数据
```

---

## 📞 快速参考

| 操作 | 命令 |
|------|------|
| 访问UI | `http://192.168.5.110:5000` |
| 停止服务器 | `pkill -f sagin_web_visualizer` |
| 启动服务器 | `cd ~/sagin-ui && python3 sagin_web_visualizer.py &` |
| 查看日志 | `cat ~/sagin-ui/server.log` |
| 测试API | `curl http://localhost:5000/api/topology` |

---

## 🎓 使用建议

1. **第一次访问**: 在PC浏览器打开，查看整体效果
2. **展示演示**: 将浏览器全屏（F11），投影到大屏幕
3. **开发调试**: 打开浏览器开发者工具（F12）查看网络请求
4. **性能优化**: 如果卡顿，可以修改刷新频率（100ms → 500ms）

---

**文档版本**: v1.0
**创建时间**: 2025-11-14
**运行平台**: 飞腾派 (Ubuntu 20.04, Python 3.8)
**访问地址**: http://192.168.5.110:5000
