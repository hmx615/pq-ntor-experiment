# 🖥️ PQ-Tor SAGIN 前端可视化展示方案

**目标**: 10寸小屏幕实时展示系统
**创建时间**: 2025-11-06

---

## 🎯 设计目标

### 核心需求

1. **适配10寸屏幕** - 1024×600 或 1280×800 分辨率
2. **实时监控** - 显示PQ-Tor网络运行状态
3. **SAGIN可视化** - 展示空天地网络拓扑
4. **性能对比** - 直观展示实验数据
5. **易于部署** - 一键启动，无需复杂配置

### 应用场景

- ✅ 现场演示（会议、答辩）
- ✅ 硬件部署监控（飞腾派5节点）
- ✅ 实验过程可视化
- ✅ 论文配图素材
- ✅ 教学演示

---

## 🎨 界面设计方案

### 方案A: 单页仪表盘（推荐）⭐⭐⭐⭐⭐

**布局**: 分块展示，适合10寸横屏

```
┌─────────────────────────────────────────────────────────┐
│  🛰️ PQ-Tor SAGIN Network Monitor      [●实时] 15:30:45  │
├──────────────────┬──────────────────────────────────────┤
│                  │                                      │
│  Network Topology│      Performance Metrics             │
│  ┌─────────┐    │  ┌──────────┐  ┌──────────┐        │
│  │   GEO   │    │  │ Latency  │  │Bandwidth │        │
│  │  ●───●  │    │  │  50ms    │  │ 100Mbps  │        │
│  └────┬────┘    │  └──────────┘  └──────────┘        │
│       │         │                                      │
│  ┌────┴────┐    │  Circuit Status:                    │
│  │LEO LEO LEO│  │  ✓ Guard    → Middle → Exit        │
│  │ ●   ●   ●│   │  [████████████░░] 85%               │
│  └─┬─┬─┬───┘    │                                      │
│    │ │ │        │                                      │
│  ┌─┴─┴─┴───┐    │  Handshake Performance:             │
│  │Ground   │    │  ┌────────────────────────┐         │
│  │ ●  ●  ●│     │  │     49μs avg           │         │
│  └─────────┘    │  │  [Chart: CDF]          │         │
│                  │  └────────────────────────┘         │
└──────────────────┴──────────────────────────────────────┘
│ LEO: 3 nodes ● | MEO: 0 | GEO: 1 | Ground: 4 ● | Active│
└──────────────────────────────────────────────────────────┘
```

**特点**:
- 左侧: SAGIN网络拓扑动画
- 右上: 关键性能指标（大字体显示）
- 右中: 电路建立进度
- 右下: 性能图表
- 底部: 状态栏

### 方案B: 多标签页

```
┌─────────────────────────────────────────────────────────┐
│ [拓扑] [性能] [日志] [对比] [配置]         [●实时]      │
├──────────────────────────────────────────────────────────┤
│                                                          │
│              当前标签页内容                               │
│                                                          │
│                                                          │
│                                                          │
└──────────────────────────────────────────────────────────┘
```

**特点**:
- 更多信息展示空间
- 但需要切换标签

**推荐**: 方案A（信息密度高，适合演示）

---

## 🛠️ 技术架构

### 架构图

```
┌─────────────────┐
│   Web Browser   │  ← 用户访问
│  (10" Screen)   │
└────────┬────────┘
         │ HTTP
         ↓
┌─────────────────┐
│  Flask Server   │  ← Python后端API
│  (Port 8080)    │
└────────┬────────┘
         │
         ├──→ 读取实验数据 (results/sagin/*.csv)
         ├──→ 监控节点状态 (ps, netstat)
         └──→ 提供WebSocket实时更新
```

### 技术栈选择

#### 前端

| 技术 | 用途 | 理由 |
|------|------|------|
| **HTML5** | 页面结构 | 标准、兼容性好 |
| **CSS3** | 样式设计 | 支持动画、响应式 |
| **Vanilla JS** | 交互逻辑 | 轻量、无依赖 |
| **Chart.js** | 图表绘制 | 轻量(11KB)、美观 |
| **Font Awesome** | 图标 | 卫星、网络图标 |

**可选增强**:
- Vue.js (CDN) - 如需复杂状态管理
- WebSocket - 实时数据推送

#### 后端

| 技术 | 用途 | 理由 |
|------|------|------|
| **Flask** | API服务 | 轻量、易部署 |
| **Flask-CORS** | 跨域支持 | 开发便利 |
| **pandas** | 数据处理 | 读取CSV |

---

## 📐 详细设计

### 1. 网络拓扑可视化

**SAGIN三层架构**:

```html
<div class="network-layer space">
  <div class="satellite geo">GEO</div>
</div>

<div class="network-layer air">
  <div class="satellite leo">LEO-1</div>
  <div class="satellite leo">LEO-2</div>
  <div class="satellite leo">LEO-3</div>
</div>

<div class="network-layer ground">
  <div class="node client">Client</div>
  <div class="node guard">Guard</div>
  <div class="node middle">Middle</div>
  <div class="node exit">Exit</div>
</div>
```

**CSS动画**:
- 节点脉冲效果（活跃时）
- 数据流动动画（连接线）
- 电路建立高亮

### 2. 性能指标卡片

```html
<div class="metric-card">
  <div class="metric-icon">⚡</div>
  <div class="metric-value">49μs</div>
  <div class="metric-label">Handshake</div>
</div>

<div class="metric-card">
  <div class="metric-icon">🛰️</div>
  <div class="metric-value">LEO</div>
  <div class="metric-label">Network Type</div>
</div>

<div class="metric-card success">
  <div class="metric-icon">✓</div>
  <div class="metric-value">100%</div>
  <div class="metric-label">Success Rate</div>
</div>
```

### 3. 实时图表

**Chart.js配置**:

```javascript
// 握手延迟CDF图
const cdfChart = new Chart(ctx, {
  type: 'line',
  data: {
    labels: latencyData,
    datasets: [{
      label: 'PQ-Ntor',
      data: cdfData,
      borderColor: '#3498db',
      fill: false
    }]
  },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    scales: {
      x: { title: { display: true, text: 'Latency (μs)' } },
      y: { title: { display: true, text: 'CDF' }, max: 1 }
    }
  }
});
```

### 4. 电路状态指示器

```html
<div class="circuit-status">
  <div class="circuit-node active">Client</div>
  <div class="circuit-arrow">→</div>
  <div class="circuit-node active">Guard</div>
  <div class="circuit-arrow">→</div>
  <div class="circuit-node building">Middle</div>
  <div class="circuit-arrow">→</div>
  <div class="circuit-node pending">Exit</div>
</div>

<style>
.circuit-node.active { background: #27ae60; }
.circuit-node.building { background: #f39c12; animation: pulse 1s infinite; }
.circuit-node.pending { background: #95a5a6; }
</style>
```

---

## 📊 数据接口设计

### RESTful API

#### 1. 获取系统状态

```
GET /api/status
Response:
{
  "timestamp": "2025-11-06T15:30:45",
  "network_type": "LEO",
  "nodes": {
    "directory": { "status": "running", "pid": 12345 },
    "guard": { "status": "running", "pid": 12346 },
    "middle": { "status": "running", "pid": 12347 },
    "exit": { "status": "running", "pid": 12348 }
  },
  "circuit": {
    "status": "established",
    "hops": 3,
    "latency_ms": 52
  }
}
```

#### 2. 获取性能数据

```
GET /api/performance
Response:
{
  "handshake": {
    "avg_us": 49.2,
    "median_us": 41.0,
    "std_us": 23.6,
    "samples": 1000
  },
  "circuit_construction": {
    "avg_ms": 350,
    "success_rate": 0.98
  },
  "current_config": "leo"
}
```

#### 3. 获取SAGIN对比数据

```
GET /api/sagin/comparison
Response:
{
  "baseline": { "latency": 0.15, "success_rate": 1.0 },
  "leo": { "latency": 0.35, "success_rate": 0.98 },
  "meo": { "latency": 0.75, "success_rate": 0.95 },
  "geo": { "latency": 2.10, "success_rate": 0.92 }
}
```

#### 4. 获取实时日志

```
GET /api/logs?lines=50
Response:
{
  "logs": [
    "[15:30:45] Client: Circuit established",
    "[15:30:44] Middle: EXTEND2 cell received",
    "[15:30:43] Guard: PQ-Ntor handshake complete (48μs)"
  ]
}
```

### WebSocket (可选)

```javascript
// 实时数据推送
ws://localhost:8080/ws

Message format:
{
  "type": "status_update",
  "data": { /* 状态数据 */ }
}

{
  "type": "circuit_event",
  "data": {
    "event": "hop_established",
    "hop": 2
  }
}
```

---

## 🎨 配色方案

### 主题色

```css
:root {
  /* 主色调 */
  --primary: #3498db;      /* 蓝色 - 主要元素 */
  --success: #27ae60;      /* 绿色 - 成功/活跃 */
  --warning: #f39c12;      /* 橙色 - 警告/进行中 */
  --danger: #e74c3c;       /* 红色 - 错误 */
  --info: #9b59b6;         /* 紫色 - 信息 */

  /* 网络层颜色 */
  --space-color: #2c3e50;  /* 太空层 - 深蓝 */
  --air-color: #34495e;    /* 空中层 - 灰蓝 */
  --ground-color: #7f8c8d; /* 地面层 - 灰色 */

  /* 背景和文字 */
  --bg-dark: #1a1a1a;
  --bg-card: #2d2d2d;
  --text-primary: #ecf0f1;
  --text-secondary: #bdc3c7;
}
```

### 暗色主题（推荐）

适合演示场景，减少眩光：

```css
body {
  background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
  color: var(--text-primary);
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

.card {
  background: var(--bg-card);
  border-radius: 8px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
  padding: 16px;
}
```

---

## 📱 响应式设计

### 10寸屏幕优化

```css
/* 1024×600 分辨率 */
@media (max-width: 1024px) and (max-height: 600px) {
  .metric-card {
    font-size: 1.2em;
    padding: 12px;
  }

  .network-topology {
    max-height: 400px;
  }

  .chart-container {
    max-height: 250px;
  }
}

/* 1280×800 分辨率 */
@media (min-width: 1024px) and (max-width: 1280px) {
  .metric-card {
    font-size: 1.5em;
    padding: 16px;
  }

  .network-topology {
    max-height: 500px;
  }
}
```

---

## 🚀 部署方案

### 方式1: 本地部署（推荐）

**目录结构**:
```
web-dashboard/
├── index.html           # 主页面
├── css/
│   └── style.css       # 样式
├── js/
│   ├── main.js         # 主逻辑
│   ├── chart.min.js    # Chart.js
│   └── api.js          # API调用
├── api/
│   └── server.py       # Flask后端
└── data/
    └── (实验数据)
```

**启动命令**:
```bash
# 1. 启动后端API
cd web-dashboard/api
python3 server.py

# 2. 打开浏览器
chromium-browser --kiosk http://localhost:8080
# 或
firefox --kiosk http://localhost:8080
```

### 方式2: 静态部署

如果不需要实时数据，可以生成静态页面：

```bash
# 导出当前数据为JSON
python3 export_data.py > data/current.json

# 直接在浏览器打开
chromium-browser --kiosk file:///path/to/index.html
```

### 方式3: 树莓派/飞腾派

```bash
# 安装依赖
sudo apt install python3-flask python3-pandas chromium-browser

# 开机自启动
sudo nano /etc/rc.local
# 添加：
cd /home/ccc/pq-ntor-experiment/web-dashboard/api
python3 server.py &
chromium-browser --kiosk http://localhost:8080 &
```

---

## 🎬 演示模式

### 自动播放模式

适合无人值守演示：

```javascript
// 自动切换网络配置演示
const configs = ['baseline', 'leo', 'meo', 'geo'];
let currentIndex = 0;

setInterval(() => {
  currentIndex = (currentIndex + 1) % configs.length;
  loadConfigData(configs[currentIndex]);
}, 10000); // 每10秒切换
```

### 全屏模式

```javascript
// F11或按钮触发全屏
function toggleFullscreen() {
  if (!document.fullscreenElement) {
    document.documentElement.requestFullscreen();
  } else {
    document.exitFullscreen();
  }
}
```

---

## 📈 功能优先级

### Phase 1 - MVP (1-2天) ⭐⭐⭐⭐⭐

- [x] 基础页面布局
- [x] SAGIN网络拓扑静态展示
- [x] 性能指标卡片
- [x] 简单的后端API（读取CSV）
- [x] 基础图表展示

### Phase 2 - 增强 (2-3天) ⭐⭐⭐⭐

- [ ] 实时数据更新（轮询）
- [ ] 电路建立动画
- [ ] 节点状态监控
- [ ] 历史数据图表
- [ ] 日志滚动显示

### Phase 3 - 高级 (3-5天) ⭐⭐⭐

- [ ] WebSocket实时推送
- [ ] 配置切换（Baseline/LEO/MEO/GEO）
- [ ] 性能对比视图
- [ ] 数据导出功能
- [ ] 主题切换（暗色/亮色）

---

## 🎯 下一步行动

### 立即开始（今天）

1. 创建基础HTML页面
2. 实现SAGIN拓扑可视化
3. 创建简单的Flask API
4. 读取实验数据并展示

### 明天

1. 完善样式和响应式布局
2. 添加Chart.js图表
3. 实现实时数据更新
4. 测试10寸屏幕显示效果

### 本周

1. 完成所有核心功能
2. 在飞腾派上部署测试
3. 录制演示视频
4. 准备论文答辩素材

---

## 💡 创意功能

### 1. AR效果（可选）

使用CSS 3D Transform创建立体效果：

```css
.satellite {
  transform: perspective(1000px) rotateX(20deg);
  animation: float 3s ease-in-out infinite;
}

@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}
```

### 2. 声音提示（可选）

```javascript
// 电路建立成功时播放音效
const successSound = new Audio('sounds/success.mp3');
successSound.play();
```

### 3. 数据统计面板

```
总测试次数: 120
成功率: 97.5%
平均延迟: 0.42s
最佳配置: LEO
```

---

## 📋 检查清单

### 开发前

- [ ] 确定展示内容优先级
- [ ] 设计UI原型（纸上草图）
- [ ] 准备测试数据
- [ ] 选择技术栈

### 开发中

- [ ] 创建HTML基础结构
- [ ] 实现CSS样式
- [ ] 编写JavaScript逻辑
- [ ] 开发Flask API
- [ ] 集成图表库

### 测试

- [ ] 在10寸屏幕上测试
- [ ] 检查所有功能正常
- [ ] 性能优化（加载速度）
- [ ] 兼容性测试（不同浏览器）

### 部署

- [ ] 编写部署文档
- [ ] 配置自启动脚本
- [ ] 准备演示数据
- [ ] 录制使用视频

---

**下一步**: 是否开始创建实际的代码文件？

我可以立即为您创建：
1. 完整的HTML+CSS+JS前端页面
2. Flask后端API服务
3. 部署和运行脚本
4. 使用文档

请告诉我是否继续！🚀
