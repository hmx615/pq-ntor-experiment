# PQ-NTOR SAGIN 实验参数文档

## 1. 实验概述

本实验在12种SAGIN（空-天-地一体化网络）拓扑下，对比评估经典ntor、PQ-NTOR和混合NTOR三种密钥协商协议的性能表现。

**实验平台**: WSL2 (Linux 6.6.87.2-microsoft-standard-WSL2)
**实验日期**: 2025-12-15
**协议类型**:
- Classic NTOR: 基于X25519的经典Tor密钥协商
- PQ-NTOR: 基于ML-KEM-768的后量子密钥协商
- Hybrid NTOR: X25519 + ML-KEM-768 混合方案


---

## 2. 功率参数设置

> **参考说明**: 实际LEO卫星发射功率约10 dBW (10W)，UAV通信功率约10-500 mW。本仿真采用适度放大的功率值 以确保在较窄带宽下获得合理的链路速率。

| 链路类型 | 发射功率 | 说明 |
|---------|---------|------|
| 卫星下行 (SAT → Ground/UAV) | **22.0 W** | 卫星发射功率 |
| UAV上行到卫星 (UAV → SAT) | **5.0 W** | 无人机发射功率 |
| 地面上行到卫星 (Ground → SAT) | **1.0 W** | 地面终端发射功率 |
| UAV下行 (UAV → Ground) | **5.0 W** | 无人机中继下行 |
| 地面上行到UAV (Ground → UAV) | **1.0 W** | 地面终端上行 |
| D2D链路 (Ground ↔ Ground) | **1.0 W** | 设备间直连 |

---

## 3. 带宽参数设置

| 链路类型 | 带宽 | 说明 |
|---------|------|------|
| 卫星链路 | **20 MHz** | Ku波段卫星信道 |
| UAV链路 | **2 MHz** | 空对地信道 |
| D2D链路 | **2 MHz** | 设备间直连 |

---

## 4. 天线增益参数

| 参数 | 值 | 说明 |
|------|-----|------|
| 卫星接收增益 | 32.0 dB | 上行链路卫星接收 |
| UAV发射增益 (上行) | G_UAV_TX_UL_LINEAR | 从test_satellite_noma模块导入 |
| 地面发射增益 (上行) | G_GROUND_TX_UL_LINEAR | 从test_satellite_noma模块导入 |

---

## 5. 丢包率与SINR对应关系

| SINR范围 (dB) | 丢包率 (%) |
|--------------|-----------|
| > 20 | 0.1 |
| 10 ~ 20 | 0.5 |
| 5 ~ 10 | 1.0 |
| 0 ~ 5 | 2.0 |
| -5 ~ 0 | 3.0 |
| < -5 | 5.0 |

---

## 6. 12拓扑端到端参数汇总

### 6.1 上行拓扑 (Topo 01-06)

| 拓扑ID | 名称 | 速率 (Mbps) | 延迟 (ms) | SINR (dB) | 丢包率 (%) | 跳数 |
|-------|------|-------------|-----------|-----------|-----------|------|
| topo01 | Z1 Up - 直连NOMA | 59.27 | 2.71 | -3.69 | 3.0 | 2 |
| topo02 | Z1 Up - T协作接入(混合双路径) | 16.55 | 2.72 | -3.71 | 3.0 | 4 |
| topo03 | Z3 Up - T用户协作NOMA | 25.19 | 2.71 | 8.33 | 1.0 | 3 |
| topo04 | Z4 Up - 混合直连+协作 | 23.64 | 2.72 | -3.69 | 3.0 | 3 |
| topo05 | Z5 Up - 多层树形结构 | 25.19 | 2.72 | -3.69 | 3.0 | 4 |
| topo06 | Z6 Up - 双UAV中继+T用户 | 22.91 | 2.72 | 8.31 | 1.0 | 4 |

### 6.2 下行拓扑 (Topo 07-12)

| 拓扑ID | 名称 | 速率 (Mbps) | 延迟 (ms) | SINR (dB) | 丢包率 (%) | 跳数 |
|-------|------|-------------|-----------|-----------|-----------|------|
| topo07 | Z1 Down - 直连NOMA+协作 | 69.43 | 2.71 | 4.74 | 2.0 | 3 |
| topo08 | Z2 Down - T协作接入+协作 | 44.84 | 2.72 | 4.72 | 2.0 | 5 |
| topo09 | Z3 Down - T用户协作下行 | 29.84 | 2.72 | 14.26 | 0.5 | 4 |
| topo10 | Z4 Down - 混合直连+协作 | 28.29 | 2.72 | 4.74 | 2.0 | 4 |
| topo11 | Z5 Down - NOMA接收+转发+T协作 | 9.67 | 2.72 | 4.72 | 2.0 | 6 |
| topo12 | Z6 Down - 双中继NOMA接收+协作+转发 | 8.73 | 2.72 | 4.74 | 2.0 | 5 |

---

## 7. 拓扑参数范围统计

| 参数 | 最小值 | 最大值 | 单位 |
|------|--------|--------|------|
| 通信速率 | 8.73 | 69.43 | Mbps |
| 传播延迟 | 2.71 | 2.72 | ms |
| 丢包率 | 0.5 | 3.0 | % |

---

## 8. 各拓扑详细链路参数

### Topo01: Z1 Up - 直连NOMA
**描述**: SAT ← S2(地面,低RSSI) + S1(UAV,高RSSI)

| 链路 | 类型 | 速率 (Mbps) | 延迟 (ms) | SINR (dB) |
|------|------|-------------|-----------|-----------|
| s2_ground→sat | satellite_uplink | 10.27 | 2.71 | -3.69 |
| s1_uav→sat | satellite_uplink | 59.27 | 2.71 | 8.33 |

**并行接收节点**: sat

---

### Topo02: Z1 Up - T协作接入(混合双路径)
**描述**: T通过S2/R1(地面)或S1/R2(UAV)双路径上行

| 链路 | 类型 | 速率 (Mbps) | 延迟 (ms) | SINR (dB) |
|------|------|-------------|-----------|-----------|
| s2_r1_ground→sat | satellite_uplink | 10.23 | 2.71 | -3.71 |
| s1_r2_uav→sat | satellite_uplink | 59.27 | 2.71 | 8.33 |
| t_ground→s2_r1_ground | d2d | 16.55 | 0.001 | 24.90 |
| t_ground→s1_r2_uav | uav | 23.64 | 0.006 | 35.59 |

**并行接收节点**: sat

---

### Topo03: Z3 Up - T用户协作NOMA
**描述**: 两个地面T用户通过UAV中继上行

| 链路 | 类型 | 速率 (Mbps) | 延迟 (ms) | SINR (dB) |
|------|------|-------------|-----------|-----------|
| s_r_uav→sat | satellite_uplink | 59.27 | 2.71 | 8.33 |
| t2_ground→s_r_uav | uav | 23.35 | 0.006 | 35.14 |
| t1_ground→s_r_uav | uav | 25.19 | 0.004 | 37.92 |

**并行接收节点**: s_r_uav

---

### Topo04: Z4 Up - 混合直连+协作
**描述**: S2(地面)直连，T通过S1/R(UAV)上行

| 链路 | 类型 | 速率 (Mbps) | 延迟 (ms) | SINR (dB) |
|------|------|-------------|-----------|-----------|
| s2_ground→sat | satellite_uplink | 10.27 | 2.71 | -3.69 |
| s1_r_uav→sat | satellite_uplink | 59.27 | 2.71 | 8.33 |
| t_ground→s1_r_uav | uav | 23.64 | 0.006 | 35.59 |

**并行接收节点**: sat

---

### Topo05: Z5 Up - 多层树形结构
**描述**: S2(地面)直连，T1/T2通过S1/R(UAV)上行

| 链路 | 类型 | 速率 (Mbps) | 延迟 (ms) | SINR (dB) |
|------|------|-------------|-----------|-----------|
| s2_ground→sat | satellite_uplink | 10.27 | 2.71 | -3.69 |
| s1_r_uav→sat | satellite_uplink | 59.27 | 2.71 | 8.33 |
| t1_ground→s1_r_uav | uav | 25.19 | 0.004 | 37.92 |
| t2_ground→s1_r_uav | uav | 23.35 | 0.006 | 35.14 |

**并行接收节点**: sat, s1_r_uav

---

### Topo06: Z6 Up - 双UAV中继+T用户
**描述**: 两个UAV分别中继一个地面T用户

| 链路 | 类型 | 速率 (Mbps) | 延迟 (ms) | SINR (dB) |
|------|------|-------------|-----------|-----------|
| s1_r1_uav→sat | satellite_uplink | 59.27 | 2.71 | 8.33 |
| s2_r2_uav→sat | satellite_uplink | 59.20 | 2.71 | 8.31 |
| t1_ground→s1_r1_uav | uav | 25.19 | 0.004 | 37.92 |
| t2_ground→s2_r2_uav | uav | 22.91 | 0.006 | 34.48 |

**并行接收节点**: sat

---

### Topo07: Z1 Down - 直连NOMA+协作
**描述**: SAT → S1(UAV,高RSSI) + S2(地面,低RSSI), S1→S2协作

| 链路 | 类型 | 速率 (Mbps) | 延迟 (ms) | SINR (dB) |
|------|------|-------------|-----------|-----------|
| sat→s1_uav | satellite_downlink | 164.60 | 2.71 | 24.76 |
| sat→s2_ground | satellite_downlink | 39.82 | 2.71 | 4.74 |
| s1_uav→s2_ground | uav | 29.61 | 0.004 | 44.56 |

**并行接收节点**: s2_ground

---

### Topo08: Z2 Down - T协作接入+协作
**描述**: SAT → S1/R2(UAV) + S2/R1(地面) → T(地面), S1→S2协作

| 链路 | 类型 | 速率 (Mbps) | 延迟 (ms) | SINR (dB) |
|------|------|-------------|-----------|-----------|
| sat→s2_r1_ground | satellite_downlink | 39.72 | 2.71 | 4.72 |
| sat→s1_r2_uav | satellite_downlink | 164.60 | 2.71 | 24.76 |
| s1_r2_uav→s2_r1_ground | uav | 28.33 | 0.005 | 42.64 |
| s2_r1_ground→t_ground | d2d | 16.55 | 0.001 | 24.90 |
| s1_r2_uav→t_ground | uav | 28.29 | 0.006 | 42.58 |

**并行接收节点**: s2_r1_ground, t_ground

---

### Topo09: Z3 Down - T用户协作下行
**描述**: SAT → S/R(UAV) → T1(地面) + T2(地面), T1→T2协作

| 链路 | 类型 | 速率 (Mbps) | 延迟 (ms) | SINR (dB) |
|------|------|-------------|-----------|-----------|
| sat→s_r_uav | satellite_downlink | 164.60 | 2.71 | 24.76 |
| s_r_uav→t1_ground | uav | 29.84 | 0.004 | 44.91 |
| s_r_uav→t2_ground | uav | 27.99 | 0.006 | 42.13 |
| t1_ground→t2_ground | d2d | 9.58 | 0.003 | 14.26 |

**并行接收节点**: t2_ground

---

### Topo10: Z4 Down - 混合直连+协作
**描述**: SAT → S2(地面)直连 + SAT → S1/R(UAV) → T(地面), S1→S2协作

| 链路 | 类型 | 速率 (Mbps) | 延迟 (ms) | SINR (dB) |
|------|------|-------------|-----------|-----------|
| sat→s2_ground | satellite_downlink | 39.82 | 2.71 | 4.74 |
| sat→s1_r_uav | satellite_downlink | 164.60 | 2.71 | 24.76 |
| s1_r_uav→s2_ground | uav | 29.61 | 0.004 | 44.56 |
| s1_r_uav→t_ground | uav | 28.29 | 0.006 | 42.58 |

**并行接收节点**: s2_ground

---

### Topo11: Z5 Down - NOMA接收+转发+T协作
**描述**: SAT → S1(UAV) + S2/R(地面) [NOMA], S1→S2/R协作, S2/R→T1/T2, T1↔T2协作

| 链路 | 类型 | 速率 (Mbps) | 延迟 (ms) | SINR (dB) |
|------|------|-------------|-----------|-----------|
| sat→s1_uav | satellite_downlink | 164.60 | 2.71 | 24.76 |
| sat→s2_r_ground | satellite_downlink | 39.75 | 2.71 | 4.72 |
| s1_uav→s2_r_ground | uav | 28.56 | 0.005 | 42.98 |
| s2_r_ground→t1_ground | d2d | 9.67 | 0.003 | 14.40 |
| s2_r_ground→t2_ground | d2d | 15.50 | 0.001 | 23.31 |
| t1_ground→t2_ground | d2d | 9.58 | 0.003 | 14.26 |

**并行接收节点**: s2_r_ground, t2_ground

---

### Topo12: Z6 Down - 双中继NOMA接收+协作+转发
**描述**: SAT → S1/R1(UAV) + S2/R2(地面) [NOMA], S1/R1→S2/R2协作, S1/R1→T1, S2/R2→T2

| 链路 | 类型 | 速率 (Mbps) | 延迟 (ms) | SINR (dB) |
|------|------|-------------|-----------|-----------|
| sat→s1_r1_uav | satellite_downlink | 164.60 | 2.71 | 24.76 |
| sat→s2_r2_ground | satellite_downlink | 39.86 | 2.71 | 4.74 |
| s1_r1_uav→s2_r2_ground | uav | 30.35 | 0.004 | 45.68 |
| s1_r1_uav→t1_ground | uav | 29.84 | 0.004 | 44.91 |
| s2_r2_ground→t2_ground | d2d | 8.73 | 0.003 | 12.92 |

**并行接收节点**: s2_r2_ground

---

## 9. 拓扑分类说明

### 9.1 Z1-Z4 对称区域 (Symmetric Zones)
- **上行 (Topo 01-04)**: 地面设备上传数据到卫星
- **下行 (Topo 07-10)**: 卫星广播数据到地面设备
- **特点**: 下行性能通常优于上行（卫星发射功率高）

### 9.2 Z5-Z6 非对称区域 (Asymmetric Zones)
- **上行 (Topo 05-06)**: 多层中继结构
- **下行 (Topo 11-12)**: 复杂协作传输
- **特点**: 上行性能可能优于下行（多跳中继增加开销）

---

## 10. 物理模型来源

本实验使用的物理层参数计算基于以下模块：
- `test_satellite_noma.py`: 卫星链路NOMA/OMA速率计算
- `test_uav_noma.py`: UAV链路速率计算
- `test_d2d_noma.py`: D2D链路速率计算
- `topology_node_positions.py`: 12拓扑节点位置定义
- `calculate_topology_params.py`: 端到端参数计算

---

## 11. 实验结果总结

根据最新实验数据 (2025-12-15):

| 指标 | Classic NTOR | PQ-NTOR | Hybrid NTOR |
|------|-------------|---------|-------------|
| 平均CBT (ms) | 17.39 | 19.04 | 19.63 |
| 标准差 (ms) | 0.31 | 1.32 | 1.38 |
| 最小值 (ms) | 16.84 | 17.64 | 18.14 |
| 最大值 (ms) | 17.76 | 21.75 | 22.44 |
| 网络延迟占比 (%) | 98.4 | 99.2 | 96.6 |

**关键发现**:
1. PQ-NTOR相比Classic NTOR增加约9.5%的CBT开销
2. Hybrid NTOR相比Classic NTOR增加约12.9%的CBT开销
3. 网络延迟占据CBT的绝大部分（>96%），密码学开销相对较小
4. 在高带宽/低延迟场景下，PQ协议开销更加明显

---

## 12. 参数与实际工程值对比分析

本节对比仿真参数与实际工程惯例值，分析差异原因。

### 12.1 参数对比表

| 参数 | 仿真值 | 实际工程惯例值 | 差异 | 差异原因 |
|------|--------|---------------|------|---------|
| 卫星下行功率 | 22 W | ~10 W (10 dBW) | 偏高2倍 | 师妹模型简化 |
| UAV发射功率 | 5 W | 10-500 mW | 偏高10-50倍 | 师妹模型+我们放大 |
| 地面上行功率 | 1 W | 10-200 mW | 偏高5-10倍 | 我们从0.2W放大到1W |
| D2D功率 | 1 W | 10-200 mW | 偏高5-10倍 | 我们从0.2W放大到1W |
| 卫星发射增益 | 32 dBi | 30-40 dBi (大天线) | 合理 | 对应1-3m Ku波段天线 |
| 用户接收增益 | 5 dBi | 10-20 dBi | 偏保守 | 小型终端场景 |
| 卫星带宽 | 20 MHz | 125-500 MHz | 偏低 | 单信道带宽 |

### 12.2 差异来源分析

**师妹原始参数 vs 我们的修改：**

| 参数 | 师妹原始值 | 我们修改后 | 修改原因 |
|------|-----------|-----------|---------|
| 卫星下行 | 20 W | 22 W | 确保下行略优于上行 |
| UAV功率 | 3 W | 5 W | 提升UAV链路质量 |
| 地面上行 | **0.2 W** | **1 W** | 确保上行链路可用 |
| D2D | **0.2 W** | **1 W** | 确保D2D链路可用 |

### 12.3 为什么结果仍然合理

尽管部分参数偏离工程惯例，但最终速率结果（8-70 Mbps）仍在合理范围：

1. **功率偏高 + 带宽偏低 → 部分抵消**
   - 功率放大提升SINR
   - 带宽降低限制最大速率
   - 两者效果互相抵消

2. **相对性能对比仍有效**
   - 本实验目的是对比Classic/PQ/Hybrid三种协议
   - 绝对值偏差不影响相对性能结论

3. **速率量级符合实际**
   - 仿真: 8-70 Mbps
   - 实际LEO (Starlink等): 50-300 Mbps
   - 量级相近，结论可参考

### 12.4 论文撰写建议

在论文中应说明：
1. 物理层参数基于文献仿真模型，非精确链路预算
2. 实验目的是**协议性能相对对比**
3. 速率、延迟的量级与实际系统相近

---

*文档生成时间: 2025-12-15*
*实验环境: WSL2 Ubuntu on Windows 11*
