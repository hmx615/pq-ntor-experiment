# PQ-NTOR SAGIN 实验参数文档 (新带宽版本)

## 修改说明

本文档是 `EXPERIMENT_PARAMETERS.md` 的修改版本，**仅调整了带宽参数**，功率保持不变。

### 参数变更对比

| 参数 | 原值 | 新值 | 变化 |
|------|------|------|------|
| 卫星带宽 | 20 MHz | **100 MHz** | 5倍 |
| UAV带宽 | 2 MHz | **10 MHz** | 5倍 |
| D2D带宽 | 2 MHz | **10 MHz** | 5倍 |
| 所有功率参数 | 保持不变 | 保持不变 | - |

---

## 1. 实验概述

本实验在12种SAGIN（空-天-地一体化网络）拓扑下，对比评估经典ntor、PQ-NTOR和混合NTOR三种密钥协商协议的性能表现。

**实验平台**: WSL2 (Linux 6.6.87.2-microsoft-standard-WSL2)
**参数版本**: 新带宽版本 (2025-12-16)
**协议类型**:
- Classic NTOR: 基于X25519的经典Tor密钥协商
- PQ-NTOR: 基于ML-KEM-768的后量子密钥协商
- Hybrid NTOR: X25519 + ML-KEM-768 混合方案

---

## 2. 功率参数设置 (与原版相同)

| 链路类型 | 发射功率 | 说明 |
|---------|---------|------|
| 卫星下行 (SAT → Ground/UAV) | **22.0 W** | 卫星发射功率 |
| UAV上行到卫星 (UAV → SAT) | **5.0 W** | 无人机发射功率 |
| 地面上行到卫星 (Ground → SAT) | **1.0 W** | 地面终端发射功率 |
| UAV下行 (UAV → Ground) | **5.0 W** | 无人机中继下行 |
| 地面上行到UAV (Ground → UAV) | **1.0 W** | 地面终端上行 |
| D2D链路 (Ground ↔ Ground) | **1.0 W** | 设备间直连 |

---

## 3. 带宽参数设置 (新版本)

| 链路类型 | 原带宽 | 新带宽 | 变化 | 说明 |
|---------|--------|--------|------|------|
| 卫星链路 | 20 MHz | **100 MHz** | 5× | Ku/Ka波段多载波聚合 |
| UAV链路 | 2 MHz | **10 MHz** | 5× | LTE/5G空对地信道 |
| D2D链路 | 2 MHz | **10 MHz** | 5× | 设备间宽带链路 |

**带宽选择依据**：
- 卫星100 MHz：参考Starlink单用户信道带宽
- UAV/D2D 10 MHz：参考LTE标准信道带宽

---

## 4. 天线增益参数 (与原版相同)

| 参数 | 值 | 说明 |
|------|-----|------|
| 卫星接收增益 | 32.0 dB | 上行链路卫星接收 |
| UAV发射增益 (上行) | G_UAV_TX_UL_LINEAR | 从test_satellite_noma模块导入 |
| 地面发射增益 (上行) | G_GROUND_TX_UL_LINEAR | 从test_satellite_noma模块导入 |

---

## 5. 丢包率与SINR对应关系 (与原版相同)

| SINR范围 (dB) | 丢包率 (%) |
|--------------|-----------|
| > 20 | 0.1 |
| 10 ~ 20 | 0.5 |
| 5 ~ 10 | 1.0 |
| 0 ~ 5 | 2.0 |
| -5 ~ 0 | 3.0 |
| < -5 | 5.0 |

---

## 6. 12拓扑端到端参数汇总 (新带宽计算结果)

### 6.1 上行拓扑 (Topo 01-06)

| 拓扑ID | 名称 | 原速率 (Mbps) | **新速率 (Mbps)** | 延迟 (ms) | **丢包率 (%)** |
|-------|------|--------------|-------------------|-----------|---------------|
| topo01 | Z1 Up - 直连NOMA | 59.27 | **123.89** | 2.71 | 5.0 |
| topo02 | Z1 Up - T协作接入(混合双路径) | 16.55 | **59.73** | 2.72 | 5.0 |
| topo03 | Z3 Up - T用户协作NOMA | 25.19 | **102.76** | 2.71 | 2.0 |
| topo04 | Z4 Up - 混合直连+协作 | 23.64 | **95.02** | 2.72 | 5.0 |
| topo05 | Z5 Up - 多层树形结构 | 25.19 | **102.76** | 2.72 | 5.0 |
| topo06 | Z6 Up - 双UAV中继+T用户 | 22.91 | **91.33** | 2.72 | 2.0 |

### 6.2 下行拓扑 (Topo 07-12)

| 拓扑ID | 名称 | 原速率 (Mbps) | **新速率 (Mbps)** | 延迟 (ms) | **丢包率 (%)** |
|-------|------|--------------|-------------------|-----------|---------------|
| topo07 | Z1 Down - 直连NOMA+协作 | 69.43 | **192.18** | 2.71 | 3.0 |
| topo08 | Z2 Down - T协作接入+协作 | 44.84 | **177.95** | 2.72 | 3.0 |
| topo09 | Z3 Down - T用户协作下行 | 29.84 | **125.97** | 2.72 | 1.0 |
| topo10 | Z4 Down - 混合直连+协作 | 28.29 | **118.22** | 2.72 | 3.0 |
| topo11 | Z5 Down - NOMA接收+转发+T协作 | 9.67 | **27.04** | 2.72 | 3.0 |
| topo12 | Z6 Down - 双中继NOMA接收+协作+转发 | 8.73 | **22.98** | 2.72 | 3.0 |

---

## 7. 新旧参数对比统计

### 7.1 速率对比

| 统计项 | 原参数 | 新参数 | 变化 |
|--------|--------|--------|------|
| 最小速率 | 8.73 Mbps | **22.98 Mbps** | +2.6× |
| 最大速率 | 69.43 Mbps | **192.18 Mbps** | +2.8× |
| 平均速率 | ~30.28 Mbps | **103.32 Mbps** | +3.4× |

### 7.2 丢包率对比

| 统计项 | 原参数 | 新参数 | 说明 |
|--------|--------|--------|------|
| 最小丢包率 | 0.5% | **1.0%** | 因带宽增加，SINR下降 |
| 最大丢包率 | 3.0% | **5.0%** | 因带宽增加，SINR下降 |
| 平均丢包率 | ~1.9% | **3.33%** | 略有增加 |

### 7.3 延迟对比

| 统计项 | 原参数 | 新参数 | 说明 |
|--------|--------|--------|------|
| 延迟范围 | 2.71-2.72 ms | 2.71-2.72 ms | 不变 |

**延迟不变原因**: 延迟由传播距离决定，与带宽无关。

---

## 8. 关键分析

### 8.1 为什么速率增加约3.4倍而不是5倍？

虽然带宽增加了5倍，但速率只增加约3.4倍，原因：

1. **香农公式非线性**: R = B × log₂(1 + SINR)
   - 带宽B增加5倍
   - 但噪声功率也随带宽增加5倍
   - SINR下降，log₂项减小

2. **净效果**: 约3.4倍速率提升

### 8.2 丢包率增加原因

带宽增加导致噪声功率增加：
- 噪声功率 = N₀ × B
- B增加5倍 → 噪声增加5倍 → SINR下降约7 dB
- 根据SINR-丢包率映射表，丢包率上升

### 8.3 工程合理性

| 指标 | 新参数值 | 工程参考值 | 评价 |
|------|---------|-----------|------|
| 卫星速率 | 60-192 Mbps | Starlink: 50-300 Mbps | 合理 |
| UAV速率 | 23-102 Mbps | 5G: 100+ Mbps | 合理 |
| D2D速率 | 10-60 Mbps | WiFi: 50-600 Mbps | 偏保守 |
| 卫星延迟 | ~2.7 ms | LEO: 20-40 ms | 偏低(距离近) |
| 丢包率 | 1-5% | 卫星: 0.1-3% | 略高 |

---

## 9. 与原参数的完整对比表

| 拓扑 | 原速率 | 新速率 | 速率变化 | 延迟 | 原丢包 | 新丢包 |
|------|--------|--------|---------|------|--------|--------|
| T01 | 59.27 | 123.89 | +2.09× | 2.71 | 3.0% | 5.0% |
| T02 | 16.55 | 59.73 | +3.61× | 2.72 | 3.0% | 5.0% |
| T03 | 25.19 | 102.76 | +4.08× | 2.71 | 1.0% | 2.0% |
| T04 | 23.64 | 95.02 | +4.02× | 2.72 | 3.0% | 5.0% |
| T05 | 25.19 | 102.76 | +4.08× | 2.72 | 3.0% | 5.0% |
| T06 | 22.91 | 91.33 | +3.99× | 2.72 | 1.0% | 2.0% |
| T07 | 69.43 | 192.18 | +2.77× | 2.71 | 2.0% | 3.0% |
| T08 | 44.84 | 177.95 | +3.97× | 2.72 | 2.0% | 3.0% |
| T09 | 29.84 | 125.97 | +4.22× | 2.72 | 0.5% | 1.0% |
| T10 | 28.29 | 118.22 | +4.18× | 2.72 | 2.0% | 3.0% |
| T11 | 9.67 | 27.04 | +2.80× | 2.72 | 2.0% | 3.0% |
| T12 | 8.73 | 22.98 | +2.63× | 2.72 | 2.0% | 3.0% |

---

## 10. 是否应该采用新参数？

### 10.1 优点

1. **速率更符合5G/6G时代预期**
   - 100+ Mbps 符合现代卫星通信标准
   - 更接近Starlink等实际系统

2. **带宽参数更合理**
   - 100 MHz卫星带宽符合Ku/Ka波段标准
   - 10 MHz符合LTE/5G信道规范

### 10.2 缺点

1. **丢包率增加**
   - 平均从~1.9%增加到~3.3%
   - 但仍在卫星通信可接受范围内

2. **需要重跑实验**
   - 更新tc参数并重新收集CBT数据

### 10.3 建议

如果导师认为原参数的速率偏低(8-70 Mbps)，可以采用新带宽参数：
- 速率提升到23-192 Mbps，更符合现代标准
- 丢包率增加可接受（1-5%）
- 延迟不变

---

## 11. 实施步骤

如果决定采用新参数，需要：

1. **更新topology_params.json**
   - 用新速率替换原速率

2. **更新topology_tc_params.json**
   - 重新计算tc netem参数

3. **重跑Phase 3实验**
   - 在WSL2或飞腾派上重新收集CBT数据

4. **重新生成图表**
   - 更新所有Phase 3可视化图表

---

*文档生成时间: 2025-12-16*
*参数计算脚本: /home/ccc/pq-ntor-experiment/last_experiment/calculate_new_params.py*
